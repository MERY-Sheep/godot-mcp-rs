# Godot MCP Server ロードマップ 🚀

> **目標**: 最強の Godot MCP サーバーを構築する

## 現在のステータス

| 指標                 | 現状                        |
| :------------------- | :-------------------------- |
| ツール数             | **56+**                     |
| 実装言語             | Rust                        |
| リアルタイム操作     | ✅ 対応 (`live-*` ツール群) |
| Undo/Redo 統合       | ✅ 完全対応                 |
| エディタープラグイン | ✅ GDScript                 |
| CLI モード           | ✅ 対応                     |

---

## Phase 1: ビジュアル検証システム 📸　＊一時凍結

**優先度: 🔴 最高** | **目標: 競合 GDAI MCP との機能差を埋める**

### 1.1 スクリーンショットキャプチャ

- [ ] `live_capture_screenshot` - エディタービューポートのスクリーンショット取得
- [ ] `live_capture_game_screenshot` - 実行中ゲームのスクリーンショット取得
- [ ] 画像を Base64 で MCP レスポンスに含める

### 1.2 ビジュアル検証ループ

- [ ] AI がゲームを実行 → スクリーンショット撮影 → 結果検証のフロー
- [ ] 期待する状態との差分検出（例: 壁の色が変わったか確認）

### 1.3 実装詳細

```
Godot Plugin側:
  - get_viewport().get_texture().get_image() でキャプチャ
  - PNG/WebP形式でBase64エンコード

Rust CLI側:
  - 画像データをMCPレスポンスとして返却
  - オプションでファイル保存
```

---

## Phase 2: 高度なデバッグ統合 🐛

**優先度: 🟠 高** | **目標: AI による完全自動デバッグ**

### 2.1 エラー情報取得

- [ ] `live_get_parse_errors` - スクリプトの構文エラーをリアルタイム取得
- [ ] `live_get_debugger_errors` - デバッガーパネルからエラー取得
- [ ] `live_get_warnings` - エディター警告の取得

### 2.2 ブレークポイント制御

- [ ] `live_set_breakpoint` - ブレークポイントの設定
- [ ] `live_remove_breakpoint` - ブレークポイントの削除
- [ ] `live_list_breakpoints` - ブレークポイント一覧

### 2.3 変数インスペクション

- [ ] `live_get_local_variables` - ローカル変数の取得
- [ ] `live_get_stack_trace` - スタックトレースの取得

---

## Phase 3: アセット管理強化 🎨

**優先度: 🟡 中** | **目標: 完全なアセットパイプライン**

### 3.1 リソース操作

- [ ] `create_material` - マテリアル作成
- [ ] `create_mesh` - プロシージャルメッシュ生成
- [ ] `import_asset` - 外部アセットのインポート
- [ ] `live_set_texture` - テクスチャの動的変更

### 3.2 プリセット・テンプレート拡張

- [ ] `vehicle_3d` - 車両テンプレート
- [ ] `npc_3d` - NPC テンプレート（NavMesh 対応）
- [ ] `collectible` - 収集アイテムテンプレート
- [ ] `projectile` - 弾丸・プロジェクタイルテンプレート

### 3.3 シェーダー操作

- [ ] `create_shader` - シェーダー作成
- [ ] `analyze_shader` - シェーダー解析
- [ ] `live_set_shader_param` - シェーダーパラメータ変更

---

## Phase 4: コード生成・リファクタリング 🔧

**優先度: 🟡 中** | **目標: AI による高度なコード操作**

### 4.1 コード理解

- [ ] `get_class_hierarchy` - クラス階層の取得
- [ ] `find_references` - シンボル参照検索
- [ ] `get_autoloads` - オートロード一覧
- [ ] `analyze_dependencies` - 依存関係分析

### 4.2 リファクタリング

- [ ] `rename_symbol` - シンボル名変更（ファイル横断）
- [ ] `extract_function` - 関数の抽出
- [ ] `move_node_to_scene` - ノードを別シーンに移動

### 4.3 コード生成

- [ ] `generate_input_handler` - 入力ハンドラー自動生成
- [ ] `generate_state_machine` - ステートマシン雛形生成
- [ ] `generate_test_script` - テストスクリプト生成

---

## Phase 5: パフォーマンス分析 📊

**優先度: 🟢 中-低** | **目標: パフォーマンス問題の自動検出**

### 5.1 プロファイリング

- [ ] `start_profiler` - プロファイラー開始
- [ ] `stop_profiler` - プロファイラー停止
- [ ] `get_profiler_data` - プロファイリング結果取得

### 5.2 分析ツール

- [ ] `analyze_draw_calls` - ドローコール分析
- [ ] `analyze_memory_usage` - メモリ使用量分析
- [ ] `find_performance_issues` - パフォーマンス問題検出

---

## Phase 6: マルチシーン・プロジェクト管理 🏗️

**優先度: 🟢 中-低** | **目標: 大規模プロジェクト対応**

### 6.1 プロジェクト操作

- [ ] `create_addon` - アドオン雛形作成
- [ ] `manage_export_presets` - エクスポート設定管理
- [ ] `batch_rename` - バッチリネーム

### 6.2 バージョン管理統合

- [ ] `get_git_status` - Git 状態取得
- [ ] `suggest_commit_message` - コミットメッセージ提案

---

## Phase 7: 自然言語インターフェース 🗣️

**優先度: 🔵 低** | **目標: より直感的な操作**

### 7.1 コマンド解釈

- [ ] `natural_command` - 自然言語 →MCP コマンド変換
  - 例: "プレイヤーにジャンプ機能を追加して"
  - 例: "敵がプレイヤーを追跡するようにして"

### 7.2 プロンプトテンプレート

- [ ] 各ツールに最適なプロンプトテンプレートを提供
- [ ] コンテキストアウェアなドキュメント生成

---

## Phase 8: GDExtension/C++サポート 🔩

**優先度: 🔵 低** | **目標: ネイティブコード対応**

### 8.1 GDExtension

- [ ] `analyze_gdextension` - GDExtension 解析
- [ ] `create_gdextension_binding` - バインディング生成

### 8.2 C++統合

- [ ] エンジンモジュールの解析
- [ ] カスタムノード型の検出

---

## アーキテクチャ改善案

### 短期

- [ ] **WebSocket 対応**: HTTP→WebSocket に移行し、リアルタイム双方向通信を強化
- [ ] **接続プーリング**: 複数コマンドの効率的な処理
- [ ] **エラーリカバリー**: プラグイン切断時の自動再接続

### 中期

- [ ] **イベントストリーム**: エディターイベントをリアルタイムで AI に通知
- [ ] **並列コマンド実行**: 複数ノード操作の同時実行

### 長期

- [ ] **Godot 5 対応準備**: 次期バージョンへの移行計画
- [ ] **Language Server Protocol 統合**: IDE との連携強化

---

## 競合との差分表

| 機能               | godot-mcp-rs | GDAI MCP | ee0pdt/Godot-MCP |
| :----------------- | :----------: | :------: | :--------------: |
| ツール数           |   **56+**    |   多数   |      中程度      |
| リアルタイム操作   |      ✅      |    ✅    |        ❌        |
| Undo/Redo          |      ✅      |    ❓    |        ❌        |
| スクリーンショット |  ⏳ Phase 1  |    ✅    |        ❌        |
| デバッガー統合     |  ⏳ Phase 2  |    ✅    |        ❌        |
| オープンソース     |    ✅ MIT    | ❌ 有料  |      ✅ MIT      |
| Rust 実装          |      ✅      |    ❌    |        ❌        |

---

## マイルストーン

| フェーズ  | 目標期間 | 主な成果物                     |
| :-------- | :------- | :----------------------------- |
| Phase 1   | 2 週間   | スクリーンショット検証システム |
| Phase 2   | 3 週間   | 完全デバッグ統合               |
| Phase 3   | 3 週間   | アセット管理ツール群           |
| Phase 4   | 2 週間   | リファクタリングツール         |
| Phase 5   | 2 週間   | パフォーマンス分析             |
| Phase 6-8 | 継続的   | 拡張機能                       |

---

## 貢献ガイド

新機能を追加する際は:

1. **Rust 側** (`src/tools/`): 新しいリクエスト型とハンドラーを追加
2. **プラグイン側** (`addons/godot_mcp/`): `command_handler.gd`にコマンド追加
3. **ドキュメント**: `USAGE.md`を更新
4. **テスト**: 動作確認とエッジケースのテスト

---

> 💡 **フィードバック歓迎**: このロードマップは進化し続けます。新しいアイデアや優先順位の変更は Issue で議論しましょう！
